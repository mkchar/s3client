package utils

import (
	"path"
	"strings"
)

func DetectContentType(filename string) string {
	ext := strings.ToLower(strings.TrimPrefix(path.Ext(filename), "."))
	if mimeType, ok := contentTypeMap[ext]; ok {
		return mimeType
	}
	return "application/octet-stream"
}

var contentTypeMap = map[string]string{
	"txt":          "text/plain",
	"log":          "text/plain",
	"md":           "text/markdown",
	"markdown":     "text/markdown",
	"rst":          "text/x-rst",
	"json":         "application/json",
	"jsonld":       "application/ld+json",
	"json5":        "application/json5",
	"xml":          "application/xml",
	"xsd":          "application/xml",
	"xsl":          "application/xml",
	"html":         "text/html",
	"htm":          "text/html",
	"xhtml":        "application/xhtml+xml",
	"css":          "text/css",
	"scss":         "text/x-scss",
	"sass":         "text/x-sass",
	"less":         "text/x-less",
	"js":           "application/javascript",
	"ts":           "application/typescript",
	"jsx":          "text/jsx",
	"tsx":          "text/tsx",
	"mjs":          "text/javascript",
	"csv":          "text/csv",
	"tsv":          "text/tab-separated-values",
	"yaml":         "text/yaml",
	"yml":          "text/yaml",
	"toml":         "text/toml",
	"ini":          "text/plain",
	"cfg":          "text/plain",
	"conf":         "text/plain",
	"properties":   "text/x-java-properties",
	"diff":         "text/x-diff",
	"patch":        "text/x-patch",
	"go":           "text/x-go",
	"py":           "text/x-python",
	"pyw":          "text/x-python",
	"java":         "text/x-java-source",
	"c":            "text/x-csrc",
	"h":            "text/x-chdr",
	"cpp":          "text/x-c++src",
	"cxx":          "text/x-c++src",
	"cc":           "text/x-c++src",
	"hpp":          "text/x-c++hdr",
	"hh":           "text/x-c++hdr",
	"rs":           "text/x-rust",
	"php":          "text/x-php",
	"php3":         "text/x-php",
	"php4":         "text/x-php",
	"php5":         "text/x-php",
	"rb":           "text/x-ruby",
	"erb":          "text/x-ruby",
	"sh":           "text/x-shellscript",
	"bash":         "text/x-shellscript",
	"swift":        "text/x-swift",
	"kt":           "text/x-kotlin",
	"scala":        "text/x-scala",
	"clj":          "text/x-clojure",
	"sql":          "application/sql",
	"pl":           "text/x-perl",
	"pm":           "text/x-perl",
	"lua":          "text/x-lua",
	"r":            "text/x-r",
	"jl":           "text/x-julia",
	"elm":          "text/x-elm",
	"hs":           "text/x-haskell",
	"dockerfile":   "text/x-dockerfile",
	"dockerignore": "text/plain",
	"gitignore":    "text/plain",
	"editorconfig": "text/x-editorconfig",
	"makefile":     "text/x-makefile",
	"mk":           "text/x-makefile",
	"cmake":        "text/x-cmake",
	"zig":          "text/x-zig",
	"nim":          "text/x-nim",
	"dart":         "text/x-dart",
	"ex":           "text/x-elixir",
	"exs":          "text/x-elixir",
	"fs":           "text/x-fsharp",
	"fsx":          "text/x-fsharp",
	"jpg":          "image/jpeg",
	"jpeg":         "image/jpeg",
	"jpe":          "image/jpeg",
	"png":          "image/png",
	"gif":          "image/gif",
	"webp":         "image/webp",
	"bmp":          "image/bmp",
	"tiff":         "image/tiff",
	"tif":          "image/tiff",
	"ico":          "image/x-icon",
	"svg":          "image/svg+xml",
	"svgz":         "image/svg+xml",
	"heic":         "image/heic",
	"heif":         "image/heif",
	"avif":         "image/avif",
	"apng":         "image/apng",
	"exr":          "image/x-exr",
	"psd":          "image/vnd.adobe.photoshop",
	"eps":          "application/postscript",
	"jp2":          "image/jp2",
	"jpx":          "image/jpx",
	"jxr":          "image/jxr",
	"wdp":          "image/vnd.ms-photo",
	"mp4":          "video/mp4",
	"m4v":          "video/x-m4v",
	"avi":          "video/x-msvideo",
	"mov":          "video/quicktime",
	"wmv":          "video/x-ms-wmv",
	"flv":          "video/x-flv",
	"webm":         "video/webm",
	"mkv":          "video/x-matroska",
	"mpeg":         "video/mpeg",
	"mpg":          "video/mpeg",
	"mpe":          "video/mpeg",
	"3gp":          "video/3gpp",
	"3gpp":         "video/3gpp",
	"3g2":          "video/3gpp2",
	"ogv":          "video/ogg",
	// "ts":       "video/mp2t",
	"mts":      "video/mp2t",
	"m2ts":     "video/mp2t",
	"vob":      "video/dvd",
	"rm":       "application/vnd.rn-realmedia",
	"rmvb":     "application/vnd.rn-realmedia-vbr",
	"f4v":      "video/x-f4v",
	"m2v":      "video/mpeg",
	"mp3":      "audio/mpeg",
	"wav":      "audio/wav",
	"flac":     "audio/flac",
	"aac":      "audio/aac",
	"ogg":      "audio/ogg",
	"wma":      "audio/x-ms-wma",
	"m4a":      "audio/mp4",
	"opus":     "audio/opus",
	"mid":      "audio/midi",
	"midi":     "audio/midi",
	"kar":      "audio/midi",
	"alac":     "audio/x-alac",
	"ape":      "audio/ape",
	"aiff":     "audio/aiff",
	"aif":      "audio/aiff",
	"au":       "audio/basic",
	"snd":      "audio/basic",
	"gsm":      "audio/gsm",
	"zip":      "application/zip",
	"rar":      "application/vnd.rar",
	"7z":       "application/x-7z-compressed",
	"tar":      "application/x-tar",
	"gz":       "application/gzip",
	"bz2":      "application/x-bzip2",
	"xz":       "application/x-xz",
	"tgz":      "application/gzip",
	"tbz2":     "application/x-bzip-compressed-tar",
	"txz":      "application/x-xz-compressed-tar",
	"zst":      "application/zstd",
	"deb":      "application/vnd.debian.binary-package",
	"rpm":      "application/x-rpm",
	"dmg":      "application/x-apple-diskimage",
	"cab":      "application/vnd.ms-cab-compressed",
	"pdf":      "application/pdf",
	"doc":      "application/msword",
	"docx":     "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
	"dot":      "application/msword",
	"dotx":     "application/vnd.openxmlformats-officedocument.wordprocessingml.template",
	"xls":      "application/vnd.ms-excel",
	"xlsx":     "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
	"xlsm":     "application/vnd.ms-excel.sheet.macroEnabled.12",
	"xlt":      "application/vnd.ms-excel",
	"xltx":     "application/vnd.openxmlformats-officedocument.spreadsheetml.template",
	"ppt":      "application/vnd.ms-powerpoint",
	"pptx":     "application/vnd.openxmlformats-officedocument.presentationml.presentation",
	"pptm":     "application/vnd.ms-powerpoint.presentation.macroEnabled.12",
	"pps":      "application/vnd.ms-powerpoint",
	"ppsx":     "application/vnd.openxmlformats-officedocument.presentationml.slideshow",
	"odt":      "application/vnd.oasis.opendocument.text",
	"ods":      "application/vnd.oasis.opendocument.spreadsheet",
	"odp":      "application/vnd.oasis.opendocument.presentation",
	"odg":      "application/vnd.oasis.opendocument.graphics",
	"woff":     "font/woff",
	"woff2":    "font/woff2",
	"ttf":      "font/ttf",
	"otf":      "font/otf",
	"eot":      "application/vnd.ms-fontobject",
	"sfnt":     "font/sfnt",
	"db":       "application/vnd.sqlite3",
	"sqlite":   "application/vnd.sqlite3",
	"parquet":  "application/parquet",
	"avro":     "application/avro",
	"orc":      "application/orc",
	"h5":       "application/x-hdf5",
	"hdf5":     "application/x-hdf5",
	"msgpack":  "application/msgpack",
	"exe":      "application/x-msdownload",
	"msi":      "application/x-msdownload",
	"app":      "application/x-mach-binary",
	"iso":      "application/x-iso9660-image",
	"img":      "application/x-iso9660-image",
	"bin":      "application/octet-stream",
	"apk":      "application/vnd.android.package-archive",
	"ipa":      "application/vnd.iphone",
	"wasm":     "application/wasm",
	"jar":      "application/java-archive",
	"war":      "application/java-archive",
	"ear":      "application/java-archive",
	"rtf":      "application/rtf",
	"ps":       "application/postscript",
	"ai":       "application/postscript",
	"epub":     "application/epub+zip",
	"mobi":     "application/x-mobipocket-ebook",
	"azw":      "application/vnd.amazon.ebook",
	"fb2":      "application/fb2+zip",
	"chm":      "application/vnd.ms-htmlhelp",
	"swf":      "application/x-shockwave-flash",
	"p12":      "application/x-pkcs12",
	"pfx":      "application/x-pkcs12",
	"p7b":      "application/x-pkcs7-certificates",
	"pem":      "application/x-x509-ca-cert",
	"crt":      "application/x-x509-ca-cert",
	"cer":      "application/pkix-cert",
	"keystore": "application/x-java-keystore",
	"jks":      "application/x-java-keystore",
}
